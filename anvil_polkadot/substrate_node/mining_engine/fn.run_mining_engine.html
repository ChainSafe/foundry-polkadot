<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Run the mining engine background task."><title>run_mining_engine in anvil_polkadot::substrate_node::mining_engine - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-ca0dd0c4.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="anvil_polkadot" data-themes="" data-resource-suffix="" data-rustdoc-version="1.92.0-nightly (f04e3dfc8 2025-10-19)" data-channel="nightly" data-search-js="search-8d3311b9.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../../../static.files/storage-e2aeef58.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-ce535bd0.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">run_mining_engine</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../anvil_polkadot/index.html">anvil_<wbr>polkadot</a><span class="version">1.3.6</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">run_<wbr>mining_<wbr>engine</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#arguments" title="Arguments">Arguments</a></li><li><a href="#behavior" title="Behavior">Behavior</a></li><li><a href="#error-handling" title="Error Handling">Error Handling</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="index.html">In anvil_<wbr>polkadot::<wbr>substrate_<wbr>node::<wbr>mining_<wbr>engine</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../index.html">anvil_polkadot</a>::<wbr><a href="../index.html">substrate_node</a>::<wbr><a href="index.html">mining_engine</a></div><h1>Function <span class="fn">run_<wbr>mining_<wbr>engine</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/anvil_polkadot/substrate_node/mining_engine.rs.html#441-466">Source</a> </span></div><pre class="rust item-decl"><code>pub async fn run_mining_engine(engine: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;<a class="struct" href="struct.MiningEngine.html" title="struct anvil_polkadot::substrate_node::mining_engine::MiningEngine">MiningEngine</a>&gt;)</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Run the mining engine background task.</p>
<p>This is the main event loop that handles block production based on the current
mining mode. It monitors for mining mode changes, manages stream selectors for
different trigger types (intervals, transactions), and coordinates block sealing
operations.</p>
<p>The function runs indefinitely until the mining engine is shut down or a fatal
error occurs.</p>
<h2 id="arguments"><a class="doc-anchor" href="#arguments">ยง</a>Arguments</h2>
<ul>
<li><code>engine</code> - Shared reference to the mining engine to control</li>
</ul>
<h2 id="behavior"><a class="doc-anchor" href="#behavior">ยง</a>Behavior</h2>
<ul>
<li>Monitors for mining mode changes and rebuilds event streams accordingly</li>
<li>Handles interval-based mining triggers using tokio timers</li>
<li>Handles transaction-based mining triggers from the transaction pool</li>
<li>Processes block sealing commands and logs results</li>
<li>Gracefully handles non-fatal errors and continues operation</li>
<li>Terminates on fatal errors (communication failures)</li>
</ul>
<h2 id="error-handling"><a class="doc-anchor" href="#error-handling">ยง</a>Error Handling</h2>
<ul>
<li><strong>Fatal errors</strong> (Canceled, SendError): Breaks the main loop and terminates</li>
<li><strong>Non-fatal errors</strong>: Logged and operation continues</li>
<li><strong>Successful operations</strong>: Block hash is logged at debug level</li>
</ul>
</div></details></section></div></main></body></html>